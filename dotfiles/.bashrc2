export DOTHOME=$(dirname ${BASH_SOURCE[0]})
source $DOTHOME/.shell_alias
source $DOTHOME/.git_alias

export HISTSIZE=1000
export HISTCONTROL=ignoredups

if [ -t 0 ]; then
if [[ "$-" =~ "i" ]]; then
	bind '"\e[H"':"beginning-of-line"
	bind '"\e[F"':"end-of-line"
	bind '"\e\e[D"':"backward-word"
	bind '"\e\e[C"':"forward-word"
	bind '"\e[1;5D"':"backward-word"
	bind '"\e[1;5C"':"forward-word"
	bind '"\e[3;5~"':"kill-word"
	# "backward-kill-word" is 0x17 (ctrl-w), Ubuntu uses ~/.inputrc
  stty -ixon >/dev/null 2>&1
fi
fi

export HOST=$HOST
export EDITOR=vi

function prependPath() { export PATH=$1:$PATH; makePathUnique; }
function appendPath() { export PATH=$PATH:$1; makePathUnique; }
function makePathUnique() { PATH=$(echo $PATH | tr ':' '\n' | awk '!seen[$0]++' | tr '\n' ':'); }

if [[ ${BASH_VERSION:0:1} -ge 5 ]]; then
  unset USER_COLOR
  declare -A USER_COLOR
  USER_COLOR[$USER]=${COLOR_BGREEN}
  USER_COLOR[root]=${COLOR_RED}
  USER_COLOR[ec2-user]=${COLOR_ORANGE}
else
  USER_COLOR="$COLOR_NONE"
fi

function updatePS1 {
    EXITCODE=$?
    [ $EXITCODE != 0 ] && EXIT_SUFFIX=":${COLOR_RED}$EXITCODE${COLOR_NONE}" || EXIT_SUFFIX="${COLOR_NONE}";
    PS1="${USER_COLOR[$USER]}\u${COLOR_NONE}@${COLOR_ORANGE}\h ${COLOR_BLUE}\W${EXIT_SUFFIX}\n$ "
}
export PROMPT_COMMAND="updatePS1"

if [[ $UID == 0 ]]; then
  # Root user, simpler setup
  alias rm='rm -i'
  alias cp='cp -i'
  alias mv='mv -i'
else
  if [[ -e $HOME/.pyenv ]]; then
    export PYENV_ROOT="$HOME/.pyenv"
    command -v pyenv >/dev/null || export PATH="$PYENV_ROOT/bin:$PATH"
    eval "$(pyenv init -)"
  fi
fi
